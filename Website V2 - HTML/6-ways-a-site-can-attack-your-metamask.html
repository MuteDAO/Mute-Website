<!DOCTYPE html><!--  This site was created in Webflow. https://www.webflow.com  -->
<!--  Last Published: Sat Oct 08 2022 11:43:33 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="633e0e57159417e444d4301a" data-wf-site="6203e5e68b7ced26a202defe">
<head>
  <meta charset="utf-8">
  <title>6 Ways a Site Can Attack your MetaMask</title>
  <meta content="6 Ways a Site Can Attack your MetaMask" property="og:title">
  <meta content="6 Ways a Site Can Attack your MetaMask" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/mute-dao.webflow.css" rel="stylesheet" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Lato:100,100italic,300,300italic,400,400italic,700,700italic,900,900italic","Oswald:200,300,400,500,600,700","Source Code Pro:regular"]  }});</script>
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/favicon.png" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-P8KLPJ7D90"></script>
  <script type="text/javascript">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-P8KLPJ7D90', {'anonymize_ip': false});</script>
</head>
<body>
  <div class="header-image-5 wf-section">
    <div class="header-container w-container">
      <a href="wiki.html" class="hollow-button-5">❮   all STORIES</a>
    </div>
  </div>
  <div class="content-section wf-section">
    <div class="w-container">
      <div class="w-row">
        <div class="article-body-column w-col w-col-11">
          <h1 class="article-heading"><strong class="bold-text">6 Ways a Site Can Attack your MetaMask</strong></h1>
          <h2 class="heading-5">Part 1: An Unlocked MetaMask</h2>
          <p class="paragraph-10">Your unlocked MetaMask exposes the currently selected address in MetaMask to every tab you have open. If you ever switch between accounts in MetaMask while it’s unlocked, every tab you have open will also know about that other account. Since the blockchain is public, knowing an account’s address is enough to tell you every incoming and outgoing transaction in its history. If you visit EthWallet Security with an unlocked MetaMask, it shows how any site owner can use Etherscan to see your most recent incoming and outgoing transaction.</p>
          <div class="w-row">
            <div class="article-body-column w-col w-col-11">
              <h2 class="heading-5">Approach #1: Your Last Outgoing Transaction Failed</h2>
              <p class="paragraph-10">The first example on EthWallet Security demonstrates how the site can produce a fake MetaMask notification stating that your most recent outgoing transaction failed. The fake notification would have all the real details about your last outgoing transaction, including its value, the destination address, and the date. Upon hovering over this fake notification, EthWallet Security shows how the site can present you a MetaMask transaction for the same amount, but subtly to a different address. Because there is no standard for how Chrome extensions present notifications, a MetaMask user would have no way of knowing that this kind of pop-up, which created a transaction upon hovering over it, is fake.</p>
              <div class="w-row">
                <div class="article-body-column w-col w-col-11">
                  <h2 class="heading-5">Approach #2: Sign For Your Last Incoming Transaction</h2>
                  <p class="paragraph-10">Similarly, the site could take your most recent incoming transaction, with the real details about the sender address, ETH amount, and date, and claim that MetaMask requires a signature to accept it. This is not unlike signing for a package arriving at your door. While experienced blockchain users will know that incoming transactions do not require any action on the recipient’s side, it may be easy to overlook this detail when a MetaMask lookalike presents accurate details about your most recent transaction.</p>
                </div>
                <div class="author-column w-col w-col-1"></div>
              </div>
              <div class="w-row">
                <div class="article-body-column w-col w-col-11">
                  <h2 class="heading-5">Approach #3: Cloning MetaMask’s CSS</h2>
                  <p class="paragraph-10">A malicious site could take the CSS of the MetaMask pop-out and make an identical, interactive version that shows accurate details about your most recent transactions, like so: The phony pop-out would populate itself with your transaction history from Etherscan, with the exception of your most recent transaction, which the pop-out would maliciously claimed failed. The pop-out could then encourage you to re-issue the same transaction, swapping out only the destination address in the new transaction. This is identical to how MetaMask would show a real transaction failing when you click the extension.</p>
                  <div class="w-row">
                    <div class="article-body-column w-col w-col-11">
                      <h2 class="heading-5">Part 2: A Locked MetaMask</h2>
                      <p class="paragraph-10">Browsing the web with a locked MetaMask does not expose any of your MetaMask addresses to any sites. However, it does tell every site you visit that you are a MetaMask user.</p>
                    </div>
                    <div class="author-column w-col w-col-1"></div>
                  </div>
                </div>
                <div class="author-column w-col w-col-1"></div>
              </div>
              <div class="w-row">
                <div class="article-body-column w-col w-col-11">
                  <h2 class="heading-5">Approach #4: Coercing the User to Unlock Their Real MetaMask</h2>
                  <p class="paragraph-10">As mentioned earlier, visiting a site with an unlocked MetaMask means that site (along with every tab you have open) will know your wallet address, its balance, its tokens, and all of your transaction history. For an advertiser, this might be their entire goal. For an attacker, this information makes phishing the user significantly easier. EthWallet Security interactively demonstrates how a phony notification for an incoming transaction would likely be enough for a user to unlock their MetaMask, and thus expose their wallet address, balance, and transaction history.</p>
                  <div class="w-row">
                    <div class="article-body-column w-col w-col-11">
                      <h2 class="heading-5">Approach #5: Phishing the User</h2>
                      <p class="paragraph-10">The alternative to having the user open their real MetaMask is to create a fake MetaMask popout for the user to enter their password, seed phrase, or unencrypted private keys. Having a password is valuable, but an attacker would still need access to the user’s encrypted private keys. Having the user’s seed phrase or unencrypted private keys is game over for the user.</p>
                    </div>
                    <div class="author-column w-col w-col-1"></div>
                  </div>
                  <div class="w-row">
                    <div class="article-body-column w-col w-col-11">
                      <h2 class="heading-5">Approach #6: The Timing Attack</h2>
                      <p class="paragraph-10">As mentioned in this blog post by co-founder John Backus, the malicious site can wait in the background until it detects you have unlocked MetaMask in a different tab. Presumably, you unlocked MetaMask in another tab because you were expecting to make a transaction on that site, whether a dApp or exchange. Since MetaMask does not tell you from which site a transaction originated, the malicious site (no longer the tab you’re currently viewing) can present you a transaction immediately upon detecting you unlocked your MetaMask, tricking you into thinking it came from the site you expected. EthWallet Security provides users a chance to experience this timing attack first hand. You can recreate this attack yourself by visiting the site with a locked MetaMask extension. Once on the site, open a different tab to a different site, and unlock your MetaMask there. Despite being in the background, EthWallet Security detects that you have unlocked your MetaMask in a different tab and presents you with a transaction immediately upon your unlocking!</p>
                    </div>
                    <div class="author-column w-col w-col-1"></div>
                  </div>
                </div>
                <div class="author-column w-col w-col-1"></div>
              </div>
            </div>
            <div class="author-column w-col w-col-1"></div>
          </div>
        </div>
        <div class="author-column w-col w-col-1"></div>
      </div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=6203e5e68b7ced26a202defe" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
  <script>
    $(document).ready(function() {
        $(".w-webflow-badge").removeClass("w-webflow-badge").empty();
    });
</script>
</body>
</html>